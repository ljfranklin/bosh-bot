// Generated by CoffeeScript 1.10.0
(function() {
  var _, calls, createTestDoubleFunction, store, stubbings,
    slice = [].slice;

  _ = {
    tap: require('lodash/tap')
  };

  store = require('./store');

  calls = require('./store/calls');

  stubbings = require('./store/stubbings');

  module.exports = function(name) {
    return _.tap(createTestDoubleFunction(), function(testDouble) {
      var entry;
      entry = store["for"](testDouble, true);
      if (name != null) {
        entry.name = name;
        return testDouble.toString = function() {
          return "[test double for \"" + name + "\"]";
        };
      } else {
        return testDouble.toString = function() {
          return "[test double (unnamed)]";
        };
      }
    });
  };

  createTestDoubleFunction = function() {
    var testDouble;
    return testDouble = function() {
      var args;
      args = 1 <= arguments.length ? slice.call(arguments, 0) : [];
      calls.log(testDouble, args, this);
      return stubbings.invoke(testDouble, args);
    };
  };

}).call(this);
